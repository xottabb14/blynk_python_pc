# blynk_python_pc
* запуск приложений, 
* открытие веб-страниц в браузере, 
* выключение ПК,
* использование "горячих" клавиш. 

Тем, кто знаком с языком программирования Python, будет несложно расширить скрипт по своему вкусу. А пользователи с начальными знаниями легко  используют под свои нужды функции из примера.


Мы используем в примере такие инструменты:
* Python (устанавливается на компьютер, непосредственно способ управления ПК)
* NirCmd (устанавливается на компьютер, расширяет возможности управления ПК)
* Blynk (необходим для создания виртуального пульта в смартфоне)
* Навык "Домовёнок Кузя" (для связи Blynk с Алисой)


## Начало. Устанавливаем Python


Нам потребуется скачать и установить среду разработки Python (будем управлять компьютером с его помощью).
 Не так страшно иметь Python на своем компьютере. Страшно в 2020 его не иметь ))

Итак:
* Скачиваем Python https://www.python.org/downloads/.
* Запускаем установщик.
* Устанавливаем галочку на "Add Python <версия> to PATH".
 Лучше сделать папку Python доступной для переменной %PATH%.
 Если поставите Python в недоступное для переменной %PATH% место, команды запуска скриптов будут такими:
 <Диск>:\<Путь_к_директории_Python>\python.exe <имя скрипта>.py

* Нажимаем "Install Python" и продолжаем установку, соглашаясь со всем предлагаемым.

По окончании установки проверяем работоспособность, заодно ставим нужные библиотеки:
* Открываем командную строку (Нажимаем '''Win+R''', вводим '''cmd''', нажимаем Enter)
* Вводим поочередно две команды (или загружаем файл [https://yadi.sk/d/Tko9ICyWsExqeg файл-сценарий установки библиотек] и просто запускаем его):

<b>pip install blynklib</b> - библиотека Blynk для Python.

<b>pip install pyautogui</b> - библиотека для работы с горячими клавишами.

## Регистрируемся и собираем пульт в Blynk


Регистрация в Blynk подробно описана здесь https://clck.ru/LsQCe. 
 Для нашего случая неважно, какие устройство и способ подключения вы выберете при создании проекта. 
 Нам нужен только токен и любой добавленный проект.<br>

Добавляем в проект нужное количество кнопок (Button). Оформляем и подписываем по вкусу.


## Настраиваем скрипт (вариант для ленивых)

Загружаем архив https://yadi.sk/d/PVxFUNz1boEPOw с необходимыми файлами. и распаковываем его в папку C:\blynk_2_0*. В итоге на диске C:\ должна лежать папка с 7 файлами:
* blynk.py - основное тело скрипта.
* config.py - файл с конфигурацией.
* install_libs.bat - файл-сценарий для установки библиотек python из Главы 2 данной статьи.
* nircmd.exe - программулька, способная расширить возможность командной строки. Подробнее по командам [https://www.nirsoft.net/utils/nircmd.html ТУТ.]
* strt.bat - пакетный файл запуска скрипта в обычном режиме.
* strt_hide.bat - пакетный файл запуска скрипта в скрытом режиме.
* close_script.bat - пакетный файл для закрытия скрипта, который работает в скрытом режиме.

В данной версии скрипта:
* Настроено 50 виртуальных пинов для работы в трех режимах: 0 - Путь к приложению/Команда для командной строки CMD; 1 - web-ссылка для открытия файлов; 2 - сочетание клавиш.
* Виртуальный пин V0 занят для ползунка управления общей громкостью системы (для этого в приложении Blynk нужно добавить виджет "Slider" и указать ему пин V0. Пределы значений поменять с 0-1023 на 0-100, т.е. 100% громкости.)
* Настройка работы скрипта перенесена в отдельный файл config.py для более быстрого понимания.

### Настраиваем виртуальные пины
* Открываем config.py с помощью любого текстового редактора.
* Для параметра <b>blynk_token="токен_от_проекта_blynk"</b> задаем свой токен от проекта blynk.
* Для параметра <b>curpath = "С:\\blynk_2_0"</b>' задаем путь к папке со скриптом, если ставили в C:\blynk_2_0, то менять ничего не нужно. Если меняем путь, то вместо привычного одного \ ставим \\ между пунктами пути.
* Для виртуальных пинов, которые будем использовать устанавливаем требуемые параметры:
* V5=[0,"notepad.exe"] где V5 - имя виртуального пина; параметр 0 указывает на то, что при значении 1 (HIGH) на виртуальном пине будет выполняться команда CMD/запуск программы, в данном случае запустится "Блокнот".
* V1=[1,"http://yandex.ru"] где V1 - имя виртуального пина; параметр 1 указывает на то, что при значении 1 (HIGH) на виртуальном пине будет открыт сайт http://yandex.ru в стандартном браузере.
* V3=[2,"win","r"] где V3 - имя виртуального пина; параметр 2 указывает на то, что при значении 1 (HIGH) на виртуальном пине будет отработано сочетание клавиш Win+R.
Таким образом Вы можете заполнить данные для всех 50 виртуальных пинов (Помните, что работать они будут только, если вы зададите виджетам в приложении Blynk соответствующие имена виртуальных пинов).<br>
После всех изменений нужно сохранить файл config.py и запустить скрипт пакетным файлом запуска.

## Проверяем работу скрипта и кнопок


Самый простой способ запуска (тк в дальнейшем можно оперировать файлом) - с помощью bat-файла:
* Открываем блокнот (<b>Win+R</b>, вводим <b>notepad</b>, нажимаем <b>Enter</b>)
* В блокноте пишем: <b>python <путь к файлу скрипта>\blynk.py</b>
* Сохраняем файл с расширением .bat (в окне сохранения файла, в выпадающем меню "Тип" выбираем "Все файлы". Пишем имя файла <удобное_имя>.bat)
* Запускаем <удобное_имя>.bat двойным щелчком мыши и пробуем нажимать кнопки в приложении Blynk:

## И снова Алиса, и снова Кузя

Итак, у нас уже работает удалённое управление, осталось познакомить виртуальные пины Blynk с Алисой. Как это сделать, [https://clck.ru/LsXvV рассказано здесь].


## Для перфекционистов


И всех тех, кому мешает окно командной строки ;)

Конечно, для постоянного доступа к управлению нужно добавить наш файл запуска в автозагрузку windows. Но далеко не всем нужно (и понравится) иметь лишнее консольное окно, болтающееся среди остальных программ. 
Есть несколько способов его скрытия, предлагаем вариант с использованием приложения NirCmd (тем более, что объем у нее неимоверно маленький, а функционал большой).

Для этого:
* Загружаем NirCmd https://www.nirsoft.net/utils/nircmd.html на официальном сайте (внизу страницы).
* Распаковываем nircmd.exe из архива в любое удобное место.
* Меняем в нашем bat-файле строку 
 python <путь к файлу скрипта>\blynk.py
на 
 <b><Путь к файлу>\nircmd.exe exec hide</b> python <путь к файлу скрипта>\blynk.py

Теперь лишнее окно скрыто, но наблюдать и завершить его работу можно будет только из "Диспетчера задач" - по имени процесса "python".

 NirCmd пригодится и для управления функциями ПК (если укажем нужные команды в соответствующем блоке функций для пинов).

Подробнее о том, что умеет эта программулька - https://www.nirsoft.net/utils/nircmd.html в списке на официальном сайте.


## Послесловие


Скрипт является простейшим примером использования Умного дома Яндекса в управлении вашим компьютером. На его основе можно и нужно экспериментировать дальше)
В статье приведены лишь наиболее необходимые методы (например, горячие клавиши, которые можно использовать для AIMP или другого ПО, и NirCmd, которая может управлять звуком, или даже открывать cd-rom и пугать домашних, если таковой еще имеется =)


Удачи в экспериментах!
Оригинал статьи https://wiki.yaboard.com/s/hz
